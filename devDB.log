/*C3*/SET SCHEMA PUBLIC
CONNECT USER SA
DISCONNECT
/*C4*/SET SCHEMA PUBLIC
CONNECT USER SA
alter table complaint drop constraint FKAC5EFCAB347EC052
alter table complaint drop constraint FKAC5EFCABD4CC5AC6
alter table complaint drop constraint FKAC5EFCABF49D6A51
alter table complaint drop constraint FKAC5EFCAB726D9DCE
alter table shiro_role_permissions drop constraint FK389B46C98BA4B1D
alter table shiro_user drop constraint FKE5884559D4CC5AC6
alter table shiro_user_permissions drop constraint FK34555A9EADE50EFD
alter table shiro_user_roles drop constraint FKBA221057ADE50EFD
alter table shiro_user_roles drop constraint FKBA2210578BA4B1D
drop table complaint if exists
drop table complaint_type if exists
drop table customer if exists
drop table message if exists
drop table shiro_role if exists
drop table shiro_role_permissions if exists
drop table shiro_user if exists
drop table shiro_user_permissions if exists
drop table shiro_user_roles if exists
drop table utility if exists
create table complaint (id bigint generated by default as identity (start with 1), version bigint not null, affects_id bigint, content varchar(255) not null, source_id bigint, status varchar(8), type_id bigint, utility_id bigint, primary key (id))
create table complaint_type (id bigint generated by default as identity (start with 1), version bigint not null, description varchar(255) not null, menu_idx integer not null, tags varchar(255) not null, urgency_rating integer not null, primary key (id))
create table customer (id bigint generated by default as identity (start with 1), version bigint not null, account_number varchar(255), name varchar(255), phone_number varchar(255) not null, reference_no varchar(255), primary key (id))
create table message (id bigint generated by default as identity (start with 1), version bigint not null, date_created timestamp not null, message varchar(255) not null, src varchar(255) not null, primary key (id))
create table shiro_role (id bigint generated by default as identity (start with 1), version bigint not null, name varchar(255) not null, primary key (id), unique (name))
create table shiro_role_permissions (shiro_role_id bigint, permissions_string varchar(255))
create table shiro_user (id bigint generated by default as identity (start with 1), version bigint not null, email varchar(255), password_hash varchar(255) not null, username varchar(255) not null, utility_id bigint, primary key (id))
create table shiro_user_permissions (shiro_user_id bigint, permissions_string varchar(255))
create table shiro_user_roles (shiro_user_id bigint not null, shiro_role_id bigint not null, primary key (shiro_user_id, shiro_role_id))
create table utility (id bigint generated by default as identity (start with 1), version bigint not null, location varchar(255) not null, name varchar(255) not null, primary key (id))
alter table complaint add constraint FKAC5EFCAB347EC052 foreign key (source_id) references message
alter table complaint add constraint FKAC5EFCABD4CC5AC6 foreign key (utility_id) references utility
alter table complaint add constraint FKAC5EFCABF49D6A51 foreign key (type_id) references complaint_type
alter table complaint add constraint FKAC5EFCAB726D9DCE foreign key (affects_id) references customer
alter table shiro_role_permissions add constraint FK389B46C98BA4B1D foreign key (shiro_role_id) references shiro_role
alter table shiro_user add constraint FKE5884559D4CC5AC6 foreign key (utility_id) references utility
alter table shiro_user_permissions add constraint FK34555A9EADE50EFD foreign key (shiro_user_id) references shiro_user
alter table shiro_user_roles add constraint FKBA221057ADE50EFD foreign key (shiro_user_id) references shiro_user
alter table shiro_user_roles add constraint FKBA2210578BA4B1D foreign key (shiro_role_id) references shiro_role
INSERT INTO COMPLAINT_TYPE VALUES(1,0,'Water Quality',0,'Dirty,Unclean',1)
INSERT INTO COMPLAINT_TYPE VALUES(2,0,'Disconnection',1,'Disconnected',2)
INSERT INTO COMPLAINT_TYPE VALUES(3,0,'Leakages',2,'Leakages,Leak',3)
INSERT INTO COMPLAINT_TYPE VALUES(4,0,'Corruption',3,'Corruption',4)
INSERT INTO COMPLAINT_TYPE VALUES(5,0,'Wrong Billing',4,'Bill,Money,Overcharged',5)
INSERT INTO COMPLAINT_TYPE VALUES(6,0,'Faulty Meter',5,'Meter',6)
INSERT INTO COMPLAINT_TYPE VALUES(7,0,'Delay in new application',6,'Delay,application,new',7)
INSERT INTO COMPLAINT_TYPE VALUES(8,0,'Sewer Bursts',7,'Sewer,Bursts',1)
INSERT INTO UTILITY VALUES(1,0,'Nairobi','Nairobi Water Company')
INSERT INTO UTILITY VALUES(2,0,'Kikuyu','Kikuyu Water Company')
INSERT INTO SHIRO_USER VALUES(1,0,'admin@voiceh20.com','5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8','user123',NULL)
INSERT INTO SHIRO_USER VALUES(2,0,'wasreb@voiceh20.com','5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8','wasreb',NULL)
INSERT INTO SHIRO_USER VALUES(3,0,'nairobiwatercompany@voiceh20.com','03ac674216f3e15c761ee1a5e255f067953623c8b388b4459e13f978d7c846f4','nwc',1)
INSERT INTO SHIRO_USER_PERMISSIONS VALUES(1,'*:*')
INSERT INTO SHIRO_USER_PERMISSIONS VALUES(2,'utility:*')
INSERT INTO SHIRO_USER_PERMISSIONS VALUES(3,'utility:*')
